{"version":3,"sources":["main.js"],"names":["Site","mobileThreshold","init","_this","this","$","window","resize","onResize","document","ready","Video","fixWidows","each","string","html","replace","playing","toPlay","$videos","$video1","on","handleCanPlayThrough","bind","canAutoplay","threshold","bindScroll","scroll","event","scrollTop","handleScroll","playAndSwitch","$videoToPlay","play","removeClass","addClass","position","pause","off","WP","wp_debug","text"],"mappings":"AAGAA,MACEC,gBAAiB,IACjBC,KAAM,WACJ,GAAIC,OAAQC,IAEZC,GAAEC,QAAQC,OAAO,WACfJ,MAAMK,aAGRH,EAAEI,UAAUC,MAAM,WAChBP,MAAMQ,MAAMT,UAKhBM,SAAU,aAKVI,UAAW,WAETP,EAAE,kBAAkBQ,KAAK,WACvB,GAAIC,QAAST,EAAED,MAAMW,MACrBD,QAASA,OAAOE,QAAQ,YAAY,YACpCX,EAAED,MAAMW,KAAKD,YAKnBd,KAAKW,OACHM,SAAS,EACTC,OAAQ,EACRhB,KAAO,WACL,GAAIC,OAAQC,IAGZD,OAAMgB,QAAUd,EAAE,iBAGlBF,MAAMiB,QAAUf,EAAE,mBAElBF,MAAMiB,QAAQC,GAAG,iBAAkBlB,MAAMmB,qBAAqBC,KAAKpB,QAGnEA,MAAMqB,aAAc,EAGpBrB,MAAMsB,UAAY,KAIpBH,qBAAsB,WACRlB,KAGNsB,cAGRA,WAAY,WACV,GAAIvB,OAAQC,IAGZC,GAAEC,QAAQqB,OAAO,SAASC,OAExB,GAAIC,WAAYxB,EAAEC,QAAQuB,WAG1B1B,OAAM2B,aAAaD,cAIvBC,aAAc,SAASD,WACrB,GAAI1B,OAAQC,IAETD,OAAMqB,eACHrB,MAAMe,QAAUW,UAAY1B,MAAMsB,UACpCtB,MAAM4B,gBACE5B,MAAMe,QAAUW,UAA8B,GAAlB1B,MAAMsB,WAC1CtB,MAAM4B,kBAKZA,cAAe,WACb,GAAI5B,OAAQC,KAGR4B,aAAe3B,EAAEF,MAAMgB,QAAQhB,MAAMe,QAGrCf,OAAMc,UAGRe,aAAa,GAAGC,OAGhB9B,MAAMc,SAAU,EAGhBe,aAAaX,GAAG,QAAS,SAASO,OAEhCzB,MAAMc,SAAU,EAGhBd,MAAMgB,QAAQe,YAAY,YAC1BF,aAAaG,SAAS,YAGtBH,aAAa,GAAGI,SAAW,EAC3BJ,aAAa,GAAGC,OAChBD,aAAa,GAAGK,QAGhBlC,MAAMe,OAASf,MAAMe,OAAS,EAAI,EAGlCc,aAAaM,IAAI,SAGdC,GAAGC,UACJnC,EAAE,oBAAoBoC,KAAKtC,MAAMe,QAInCf,MAAM2B,aAAazB,EAAEC,QAAQuB,kBAOrC7B,KAAKE","file":"main.min.js","sourcesContent":["/* jshint browser: true, devel: true, indent: 2, curly: true, eqeqeq: true, futurehostile: true, latedef: true, undef: true, unused: true */\n/* global $, jQuery, document, Site, Modernizr */\n\nSite = {\n  mobileThreshold: 601,\n  init: function() {\n    var _this = this;\n\n    $(window).resize(function(){\n      _this.onResize();\n    });\n\n    $(document).ready(function () {\n      _this.Video.init();\n    });\n\n  },\n\n  onResize: function() {\n    var _this = this;\n\n  },\n\n  fixWidows: function() {\n    // utility class mainly for use on headines to avoid widows [single words on a new line]\n    $('.js-fix-widows').each(function(){\n      var string = $(this).html();\n      string = string.replace(/ ([^ ]*)$/,'&nbsp;$1');\n      $(this).html(string);\n    });\n  },\n};\n\nSite.Video = {\n  playing: false,\n  toPlay: 0,\n  init:  function() {\n    var _this = this;\n\n    // Selector for both videos\n    _this.$videos = $('.splash-video');\n\n    // First video\n    _this.$video1 = $('#splash-video-1');\n\n    _this.$video1.on('canplaythrough', _this.handleCanPlayThrough.bind(_this));\n\n    // TODO: Detect can autoplay\n    _this.canAutoplay = true;\n\n    // TODO: Get threshold based on video position/margin/something\n    _this.threshold = 100;\n\n  },\n\n  handleCanPlayThrough: function() {\n    var _this = this;\n\n    // Bind scroll\n    _this.bindScroll();\n  },\n\n  bindScroll: function() {\n    var _this = this;\n\n    // On window scroll\n    $(window).scroll(function(event) {\n      // Get the scroll position\n      var scrollTop = $(window).scrollTop();\n\n      // ...handle it\n      _this.handleScroll(scrollTop);\n    });\n  },\n\n  handleScroll: function(scrollTop) {\n    var _this = this;\n\n    if(_this.canAutoplay) {\n      if(!_this.toPlay && scrollTop > _this.threshold) { // First video is to play and postition is below threshold\n        _this.playAndSwitch();\n      } else if(_this.toPlay && scrollTop < _this.threshold * 0.8) { // second video is to play and postition is above threshold * 0.8. Value was made up, it will change based on design\n        _this.playAndSwitch();\n      }\n    }\n  },\n\n  playAndSwitch: function() {\n    var _this = this;\n\n    // Get video to play\n    var $videoToPlay = $(_this.$videos[_this.toPlay]);\n\n    // Check it isn't playing already\n    if(!_this.playing) {\n\n      // Play video\n      $videoToPlay[0].play();\n\n      // Set playing to true\n      _this.playing = true;\n\n      // Listen for video ended event\n      $videoToPlay.on('ended', function(event) {\n        // Set playing to false\n        _this.playing = false;\n\n        // Switch videos\n        _this.$videos.removeClass('u-hidden');\n        $videoToPlay.addClass('u-hidden');\n\n        // Reset position to 0\n        $videoToPlay[0].position = 0;\n        $videoToPlay[0].play();\n        $videoToPlay[0].pause();\n\n        // Switch toPlay value\n        _this.toPlay = _this.toPlay ? 0 : 1;\n\n        // Remove event\n        $videoToPlay.off('ended');\n\n        // DEBUG\n        if(WP.wp_debug) {\n          $('#video-displayed').text(_this.toPlay);\n        }\n\n        // Recheck scroll position in case user scrolled while playing\n        _this.handleScroll($(window).scrollTop());\n\n      });\n    }\n  },\n};\n\nSite.init();\n"]}