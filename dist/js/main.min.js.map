{"version":3,"sources":["main.js"],"names":["Site","animationSpeed","mobileThreshold","init","_this","this","fixWidows","Menu","Countdown","$","window","resize","onResize","document","ready","SplashVideo","WhatIsVideo","Modules","each","string","html","replace","playing","toPlay","length","$videos","$video1","readyState","bindScroll","on","handleCanPlayThrough","bind","canAutoplay","threshold","offset","top","height","off","scroll","event","scrollTop","handleScroll","playAndSwitch","$videoToPlay","play","removeClass","addClass","currentTime","WP","wp_debug","text","$player","$video","handleClick","hasClass","pause","$mobileHeader","mobileHeaderOffset","outerHeight","innerHeight","section","data","isMobile","scrollTo","toggleClass","$target","headerOffset","stop","animate","dayInSeconds","hoursInSeconds","interval","undefined","$countdown","$countdownDays","$countdownHours","$countdownMinutes","$countdownSeconds","end","now","moment","utc","nowUnixTimestampSeconds","format","secondsRemaining","checkFinished","displayRemainingTime","setInterval","daysRemaining","daysRemainingRemainder","displayValueFromFloat","hoursRemaining","hoursRemainingRemainder","minutesRemaining","minutesRemainingRemainder","clearInterval","remove","input","padNumber","Math","floor","n","Array","join","played","bindHover","video","playAnimation","index","setTimeout","callback","loop"],"mappings":"AAGAA,MACEC,eAAgB,IAChBC,gBAAiB,IACjBC,KAAM,WACJ,GAAIC,OAAQC,IAEZD,OAAME,YAELF,MAAMG,KAAKJ,OACXC,MAAMI,UAAUL,OAEjBM,EAAEC,QAAQC,OAAO,WACfP,MAAMQ,aAGRH,EAAEI,UAAUC,MAAM,WAChBV,MAAMW,YAAYZ,OAClBC,MAAMY,YAAYb,OAClBC,MAAMa,QAAQd,UAKlBS,SAAU,WACIP,KAENU,YAAYH,YAGpBN,UAAW,WAETG,EAAE,kBAAkBS,KAAK,WACvB,GAAIC,QAASV,EAAEJ,MAAMe,MACrBD,QAASA,OAAOE,QAAQ,YAAY,YACpCZ,EAAEJ,MAAMe,KAAKD,YAKnBnB,KAAKe,aACHO,SAAS,EACTC,OAAQ,EACRpB,KAAO,WACL,GAAIC,OAAQC,IAGRI,GAAE,2BAA2Be,SAG/BpB,MAAMqB,QAAUhB,EAAE,iBAGlBL,MAAMsB,QAAUjB,EAAE,mBAGdL,MAAMsB,QAAQ,GAAGC,WAAa,EAChCvB,MAAMwB,aAENxB,MAAMsB,QAAQG,GAAG,wBAAyBzB,MAAM0B,qBAAqBC,KAAK3B,QAI5EA,MAAM4B,aAAc,EAGpB5B,MAAM6B,UAAa7B,MAAMsB,QAAQQ,SAASC,IAAM,IAMpDvB,SAAU,WACR,GAAIR,OAAQC,IAEZD,OAAM6B,UAAY7B,MAAMsB,QAAQQ,SAASC,IAAO1B,EAAEC,QAAQ0B,SAAW,EAAK,GAG5EN,qBAAsB,WACpB,GAAI1B,OAAQC,IAGZD,OAAMsB,QAAQW,IAAI,yBAGlBjC,MAAMwB,cAGRA,WAAY,WACV,GAAIxB,OAAQC,IAGZI,GAAEC,QAAQ4B,OAAO,SAASC,OAExB,GAAIC,WAAY/B,EAAEC,QAAQ8B,WAG1BpC,OAAMqC,aAAaD,cAIvBC,aAAc,SAASD,WACrB,GAAIpC,OAAQC,IAETD,OAAM4B,eACH5B,MAAMmB,QAAUiB,UAAYpC,MAAM6B,UACpC7B,MAAMsC,gBACEtC,MAAMmB,QAAUiB,UAA8B,GAAlBpC,MAAM6B,WAC1C7B,MAAMsC,kBAKZA,cAAe,WACb,GAAItC,OAAQC,KAGRsC,aAAelC,EAAEL,MAAMqB,QAAQrB,MAAMmB,QAGrCnB,OAAMkB,UAGRqB,aAAa,GAAGC,OAGhBxC,MAAMkB,SAAU,EAGhBqB,aAAad,GAAG,QAAS,SAASU,OAEhCnC,MAAMkB,SAAU,EAGhBlB,MAAMqB,QAAQoB,YAAY,YAC1BF,aAAaG,SAAS,YAGtBH,aAAa,GAAGI,YAAc,EAG9B3C,MAAMmB,OAASnB,MAAMmB,OAAS,EAAI,EAGlCoB,aAAaN,IAAI,SAGdW,GAAGC,UACJxC,EAAE,oBAAoByC,KAAK9C,MAAMmB,QAInCnB,MAAMqC,aAAahC,EAAEC,QAAQ8B,kBAOrCxC,KAAKgB,aACHmC,QAAS1C,EAAE,yBACX2C,OAAQ3C,EAAE,kBAEVN,KAAM,WACJ,GAAIC,OAAQC,IAEZD,OAAM+C,QAAQtB,GAAG,QAASzB,MAAMiD,YAAYtB,KAAK3B,SAGnDiD,YAAa,WACX,GAAIjD,OAAQC,IAERD,OAAM+C,QAAQG,SAAS,YACzBlD,MAAMgD,OAAO,GAAGG,QAChBnD,MAAM+C,QAAQN,YAAY,aAE1BzC,MAAMgD,OAAO,GAAGR,OAChBxC,MAAM+C,QAAQL,SAAS,cAM7B9C,KAAKO,MACHJ,KAAM,WACJ,GAAIC,OAAQC,IAEZmD,eAAgB/C,EAAE,kBAElBL,MAAMqD,mBAAqBD,cAAcE,eAAiBF,cAAcG,cAAgBH,cAAcpB,UAEtG3B,EAAE,gBAAgBoB,GAAG,QAAS,WAC5B,GAAI+B,SAAUnD,EAAEJ,MAAMwD,KAAK,UACvBC,SAAWrD,EAAEJ,MAAMiD,SAAS,kBAEhClD,OAAM2D,SAASH,QAASE,YAIvBrD,EAAE,gBAAgBe,QACnBf,EAAE,gBAAgBoB,GAAG,QAAS,WAC5BpB,EAAE,QAAQuD,YAAY,gBAK5BD,SAAU,SAASH,QAASE,UAC1B,GAAI1D,OAAQC,KACR4D,QAAUxD,EAAE,YAAcmD,SAC1BM,aAAe,CAEfJ,YACFI,aAAe9D,MAAMqD,oBAGvBhD,EAAE,QAAQoC,YAAY,aACtBpC,EAAE,cAAc0D,OAAOC,SAAU5B,UAAWyB,QAAQ/B,SAASC,IAAM+B,cAAgBlE,KAAKC,kBAI5FD,KAAKQ,WACH6D,aAAc,MACdC,eAAgB,KAChBC,aAAUC,GAEVrE,KAAM,WACJ,GAAIC,OAAQC,IAEZD,OAAMqE,WAAahE,EAAE,cACrBL,MAAMsE,eAAiBjE,EAAE,mBACzBL,MAAMuE,gBAAkBlE,EAAE,oBAC1BL,MAAMwE,kBAAoBnE,EAAE,sBAC5BL,MAAMyE,kBAAoBpE,EAAE,sBAG5BL,MAAM0E,IAAM1E,MAAMqE,WAAWZ,KAAK,MAElC,IAAIkB,KAAMC,SAASC,MACfC,wBAA0BH,IAAII,OAAO,IAGzC/E,OAAMgF,iBAAmBhF,MAAM0E,IAAMI,wBAGrC9E,MAAMiF,gBACNjF,MAAMkF,uBAGNlF,MAAMmE,SAAW7D,OAAO6E,YAAY,WAClCnF,MAAMgF,mBAENhF,MAAMiF,gBACNjF,MAAMkF,wBACL,MAILA,qBAAsB,WACpB,GAAIlF,OAAQC,KAIRmF,cAAgBpF,MAAMgF,iBAAmBhF,MAAMiE,aAC/CoB,uBAAyBrF,MAAMgF,iBAAmBhF,MAAMiE,YAE5DjE,OAAMsE,eAAexB,KAAK9C,MAAMsF,sBAAsBF,eAEtD,IAAIG,gBAAiBF,uBAAyBrF,MAAMkE,cAEpDlE,OAAMuE,gBAAgBzB,KAAK9C,MAAMsF,sBAAsBC,gBAEvD,IAAIC,yBAA0BH,uBAAyBrF,MAAMkE,eAEzDuB,iBAAmBD,wBAA0B,EAEjDxF,OAAMwE,kBAAkB1B,KAAK9C,MAAMsF,sBAAsBG,kBAEzD,IAAIC,2BAA4BF,wBAA0B,EAE1DxF,OAAMyE,kBAAkB3B,KAAK9C,MAAMsF,sBAAsBI,6BAG3DT,cAAe,WACb,GAAIjF,OAAQC,IAGRD,OAAMgF,kBAAoB,IAC5B1E,OAAOqF,cAAc3F,MAAMmE,UAG3B9D,EAAE,sBAAsBuF,WAI5BN,sBAAuB,SAASO,OAG9B,MAFY5F,MAEC6F,UAAUC,KAAKC,MAAMH,SAGpCC,UAAW,SAASG,GAIlB,MAFAA,IAAQ,GAEDA,EAAE7E,QAAU,EAAI6E,EAAI,GAAIC,OAAM,EAAID,EAAE7E,OAAS,GAAG+E,KAAK,KAAOF,IAIvErG,KAAKiB,SACHuF,QAAQ,EACRtE,OAAQ,EACR/B,KAAM,WACJ,GAAIC,OAAQC,IAEZD,OAAMqB,QAAUhB,EAAE,iBAElBL,MAAM6B,UAAY7B,MAAMqB,QAAQS,SAASC,IAAO1B,EAAEC,QAAQ0B,SAAW,EAAK,EAE1EhC,MAAMwB,cAGR6E,UAAW,SAASC,OAIlBjG,EAAEiG,OAAO7E,GAAG,wBAAyB,SAASU,OAC5ClC,KAAKuC,SAIPnC,EAAEiG,OAAO7E,GAAG,aAAc,SAASU,OACjClC,KAAKkD,WAIT3B,WAAY,WACV,GAAIxB,OAAQC,IAGZI,GAAEC,QAAQ4B,OAAO,SAASC,OAExB,GAAIC,WAAY/B,EAAEC,QAAQ8B,WAG1BpC,OAAMqC,aAAaD,cAIvBC,aAAc,SAASD,WACrB,GAAIpC,OAAQC,MAERD,MAAMoG,QAAUhE,UAAYpC,MAAM6B,WACpC7B,MAAMuG,iBAIVA,cAAe,WACb,GAAIvG,OAAQC,IAEZD,OAAMoG,QAAS,EAEfpG,MAAMqB,QAAQP,KAAM,SAAS0F,OAC3B,GAAIF,OAAQrG,IAEZwG,YAAY,SAASC,UACnBJ,MAAM9D,OAENnC,EAAEiG,OAAO7E,GAAG,QAAS,WACnBxB,KAAK0G,MAAO,EACZ3G,MAAMqG,UAAUpG,SAEjBD,MAAM8B,OAAS0E,WAQxB5G,KAAKG","file":"main.min.js","sourcesContent":["/* jshint browser: true, devel: true, indent: 2, curly: true, eqeqeq: true, futurehostile: true, latedef: true, undef: true, unused: true */\n/* global $, jQuery, document, Site, Modernizr */\n\nSite = {\n  animationSpeed: 666,\n  mobileThreshold: 601,\n  init: function() {\n    var _this = this;\n\n    _this.fixWidows();\n\n     _this.Menu.init();\n     _this.Countdown.init();\n\n    $(window).resize(function(){\n      _this.onResize();\n    });\n\n    $(document).ready(function () {\n      _this.SplashVideo.init();\n      _this.WhatIsVideo.init();\n      _this.Modules.init();\n    });\n\n  },\n\n  onResize: function() {\n    var _this = this;\n\n    _this.SplashVideo.onResize();\n  },\n\n  fixWidows: function() {\n    // utility class mainly for use on headines to avoid widows [single words on a new line]\n    $('.js-fix-widows').each(function(){\n      var string = $(this).html();\n      string = string.replace(/ ([^ ]*)$/,'&nbsp;$1');\n      $(this).html(string);\n    });\n  },\n};\n\nSite.SplashVideo = {\n  playing: false,\n  toPlay: 0,\n  init:  function() {\n    var _this = this;\n\n    // Init if in markup\n    if ($('#splash-video-container').length) {\n\n      // Selector for both videos\n      _this.$videos = $('.splash-video');\n\n      // First video\n      _this.$video1 = $('#splash-video-1');\n\n\n      if (_this.$video1[0].readyState > 3) {\n        _this.bindScroll();\n      } else {\n        _this.$video1.on('canplaythrough.video1', _this.handleCanPlayThrough.bind(_this));\n      }\n\n      // TODO: Detect can autoplay\n      _this.canAutoplay = true;\n\n      // Set threshold\n      _this.threshold = (_this.$video1.offset().top / 6);\n\n    }\n\n  },\n\n  onResize: function() {\n    var _this = this;\n\n    _this.threshold = _this.$video1.offset().top - ($(window).height() / 3) * 2;\n  },\n\n  handleCanPlayThrough: function() {\n    var _this = this;\n\n    // Unbind from this event so it only happens once\n    _this.$video1.off('canplaythrough.video1');\n\n    // Bind scroll\n    _this.bindScroll();\n  },\n\n  bindScroll: function() {\n    var _this = this;\n\n    // On window scroll\n    $(window).scroll(function(event) {\n      // Get the scroll position\n      var scrollTop = $(window).scrollTop();\n\n      // ...handle it\n      _this.handleScroll(scrollTop);\n    });\n  },\n\n  handleScroll: function(scrollTop) {\n    var _this = this;\n\n    if(_this.canAutoplay) {\n      if(!_this.toPlay && scrollTop > _this.threshold) { // First video is to play and postition is below threshold\n        _this.playAndSwitch();\n      } else if(_this.toPlay && scrollTop < _this.threshold * 0.8) { // second video is to play and postition is above threshold * 0.8. Value was made up, it will change based on design\n        _this.playAndSwitch();\n      }\n    }\n  },\n\n  playAndSwitch: function() {\n    var _this = this;\n\n    // Get video to play\n    var $videoToPlay = $(_this.$videos[_this.toPlay]);\n\n    // Check it isn't playing already\n    if(!_this.playing) {\n\n      // Play video\n      $videoToPlay[0].play();\n\n      // Set playing to true\n      _this.playing = true;\n\n      // Listen for video ended event\n      $videoToPlay.on('ended', function(event) {\n        // Set playing to false\n        _this.playing = false;\n\n        // Switch videos\n        _this.$videos.removeClass('u-hidden');\n        $videoToPlay.addClass('u-hidden');\n\n        // Reset position to 0\n        $videoToPlay[0].currentTime = 0;\n\n        // Switch toPlay value\n        _this.toPlay = _this.toPlay ? 0 : 1;\n\n        // Remove event\n        $videoToPlay.off('ended');\n\n        // DEBUG\n        if(WP.wp_debug) {\n          $('#video-displayed').text(_this.toPlay);\n        }\n\n        // Recheck scroll position in case user scrolled while playing\n        _this.handleScroll($(window).scrollTop());\n\n      });\n    }\n  },\n};\n\nSite.WhatIsVideo = {\n  $player: $('#what-is-video-player'),\n  $video: $('#what-is-video'),\n\n  init: function() {\n    var _this = this;\n\n    _this.$player.on('click', _this.handleClick.bind(_this));\n  },\n\n  handleClick: function() {\n    var _this = this;\n\n    if (_this.$player.hasClass('playing')) {\n      _this.$video[0].pause();\n      _this.$player.removeClass('playing');\n    } else {\n      _this.$video[0].play();\n      _this.$player.addClass('playing');\n\n    }\n  },\n};\n\nSite.Menu = {\n  init: function() {\n    var _this = this;\n\n    $mobileHeader = $('#mobile-header');\n    // mobile scrollTo offset = mobile header height + top padding + bottom padding\n    _this.mobileHeaderOffset = $mobileHeader.outerHeight() + ($mobileHeader.innerHeight() - $mobileHeader.height());\n\n    $('.js-scrollto').on('click', function() {\n      var section = $(this).data('scroll');\n      var isMobile = $(this).hasClass('mobile-scrollto');\n\n      _this.scrollTo(section, isMobile);\n    });\n\n    // Mobile Menu\n    if($('#menu-toggle').length) {\n      $('#menu-toggle').on('click', function() {\n        $('body').toggleClass('menu-open');\n      });\n    }\n  },\n\n  scrollTo: function(section, isMobile) {\n    var _this = this;\n    var $target = $('#section-' + section);\n    var headerOffset = 0;\n\n    if (isMobile) {\n      headerOffset = _this.mobileHeaderOffset;\n    }\n\n    $('body').removeClass('menu-open');\n    $('html, body').stop().animate({ scrollTop: $target.offset().top - headerOffset }, Site.animationSpeed);\n  }\n};\n\nSite.Countdown = {\n  dayInSeconds: 60 * 60 * 24,\n  hoursInSeconds: 60 * 60,\n  interval: undefined,\n\n  init: function() {\n    var _this = this;\n\n    _this.$countdown = $('#countdown');\n    _this.$countdownDays = $('#countdown-days');\n    _this.$countdownHours = $('#countdown-hours');\n    _this.$countdownMinutes = $('#countdown-minutes');\n    _this.$countdownSeconds = $('#countdown-seconds');\n\n    // get end time from markup\n    _this.end = _this.$countdown.data('end');\n\n    var now = moment().utc();\n    var nowUnixTimestampSeconds = now.format('X');\n\n    // calculate seconds between endtime and now\n    _this.secondsRemaining = _this.end - nowUnixTimestampSeconds;\n\n    // check if already finished, then display countdown values\n    _this.checkFinished();\n    _this.displayRemainingTime();\n\n    // setup interval to count down each second and update the display values\n    _this.interval = window.setInterval(function() {\n      _this.secondsRemaining--;\n\n      _this.checkFinished();\n      _this.displayRemainingTime();\n    }, 1000);\n\n  },\n\n  displayRemainingTime: function() {\n    var _this = this;\n\n    // each of these calculates the remaining values from the seconds remaining, then calculates the remainder of seconds to be used in the next step, then displays the values\n\n    var daysRemaining = _this.secondsRemaining / _this.dayInSeconds;\n    var daysRemainingRemainder = _this.secondsRemaining % _this.dayInSeconds;\n\n    _this.$countdownDays.text(_this.displayValueFromFloat(daysRemaining));\n\n    var hoursRemaining = daysRemainingRemainder / _this.hoursInSeconds;\n\n    _this.$countdownHours.text(_this.displayValueFromFloat(hoursRemaining));\n\n    var hoursRemainingRemainder = daysRemainingRemainder % _this.hoursInSeconds;\n\n    var minutesRemaining = hoursRemainingRemainder / 60;\n\n    _this.$countdownMinutes.text(_this.displayValueFromFloat(minutesRemaining));\n\n    var minutesRemainingRemainder = hoursRemainingRemainder % 60;\n\n    _this.$countdownSeconds.text(_this.displayValueFromFloat(minutesRemainingRemainder));\n  },\n\n  checkFinished: function() {\n    var _this = this;\n\n    // if there are no seconds remaining kill the countdown\n    if (_this.secondsRemaining <= 0) {\n      window.clearInterval(_this.interval);\n\n      // perhaps we have a better solution but for now just remove the countdown\n      $('#section-countdown').remove();\n    }\n  },\n\n  displayValueFromFloat: function(input) {\n    var _this = this;\n\n    return _this.padNumber(Math.floor(input));\n  },\n\n  padNumber: function(n) {\n    // adapted from https://stackoverflow.com/questions/10073699/pad-a-number-with-leading-zeros-in-javascript#10073788\n    n = n + '';\n\n    return n.length >= 2 ? n : new Array(2 - n.length + 1).join('0') + n;\n  },\n};\n\nSite.Modules = {\n  played: false,\n  offset: 0, // ms offset between each video play init\n  init: function() {\n    var _this = this;\n\n    _this.$videos = $('.module-video');\n\n    _this.threshold = _this.$videos.offset().top - ($(window).height() / 3) * 2;\n\n    _this.bindScroll();\n  },\n\n  bindHover: function(video) {\n    var _this = this;\n\n    // Bind mouse over\n    $(video).on('mouseover.videoModule', function(event) {\n      this.play();\n    });\n\n    // Bind mouse leave\n    $(video).on('mouseleave', function(event) {\n      this.pause();\n    });\n  },\n\n  bindScroll: function() {\n    var _this = this;\n\n    // On window scroll\n    $(window).scroll(function(event) {\n      // Get the scroll position\n      var scrollTop = $(window).scrollTop();\n\n      // ...handle it\n      _this.handleScroll(scrollTop);\n    });\n  },\n\n  handleScroll: function(scrollTop) {\n    var _this = this;\n\n    if(!_this.played && scrollTop > _this.threshold) { // First video is to play and postition is below threshold\n      _this.playAnimation();\n    }\n  },\n\n  playAnimation: function() {\n    var _this = this;\n\n    _this.played = true;\n\n    _this.$videos.each( function(index) {\n      var video = this;\n\n      setTimeout( function(callback) {\n        video.play();\n\n        $(video).on('ended', function() {\n          this.loop = true;\n          _this.bindHover(this);\n        });\n      }, _this.offset * index);\n    });\n\n\n  },\n\n};\n\nSite.init();\n"]}