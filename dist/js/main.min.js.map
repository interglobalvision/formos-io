{"version":3,"sources":["main.js"],"names":["Site","animationSpeed","mobileThreshold","init","_this","this","fixWidows","Menu","Countdown","$","window","resize","onResize","document","ready","SplashVideo","WhatIsVideo","each","string","html","replace","playing","toPlay","$videos","$video1","on","handleCanPlayThrough","bind","canAutoplay","threshold","off","bindScroll","scroll","event","scrollTop","handleScroll","playAndSwitch","$videoToPlay","play","removeClass","addClass","currentTime","WP","wp_debug","text","$player","$video","handleClick","hasClass","pause","section","data","scrollTo","$target","stop","animate","offset","top","$countdown","$countdownDays","$countdownHours","$countdownMinutes","$countdownSeconds","dayInSeconds","hoursInSeconds","interval","undefined","end","now","moment","utc","nowUnixTimestampSeconds","format","secondsRemaining","checkFinished","displayRemainingTime","setInterval","daysRemaining","daysRemainingRemainder","Math","floor","hoursRemaining","hoursRemainingRemainder","minutesRemaining","minutesRemainingRemainder","clearInterval","remove"],"mappings":"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","file":"main.min.js","sourcesContent":["/* jshint browser: true, devel: true, indent: 2, curly: true, eqeqeq: true, futurehostile: true, latedef: true, undef: true, unused: true */\n/* global $, jQuery, document, Site, Modernizr */\n\nSite = {\n  animationSpeed: 666,\n  mobileThreshold: 601,\n  init: function() {\n    var _this = this;\n\n    _this.fixWidows();\n\n     _this.Menu.init();\n     _this.Countdown.init();\n\n    $(window).resize(function(){\n      _this.onResize();\n    });\n\n    $(document).ready(function () {\n      _this.SplashVideo.init();\n      _this.WhatIsVideo.init();\n    });\n\n  },\n\n  onResize: function() {\n    var _this = this;\n\n  },\n\n  fixWidows: function() {\n    // utility class mainly for use on headines to avoid widows [single words on a new line]\n    $('.js-fix-widows').each(function(){\n      var string = $(this).html();\n      string = string.replace(/ ([^ ]*)$/,'&nbsp;$1');\n      $(this).html(string);\n    });\n  },\n};\n\nSite.SplashVideo = {\n  playing: false,\n  toPlay: 0,\n  init:  function() {\n    var _this = this;\n\n    // Selector for both videos\n    _this.$videos = $('.splash-video');\n\n    // First video\n    _this.$video1 = $('#splash-video-1');\n\n    _this.$video1.on('canplaythrough.video1', _this.handleCanPlayThrough.bind(_this));\n\n    // TODO: Detect can autoplay\n    _this.canAutoplay = true;\n\n    // TODO: Get threshold based on video position/margin/something\n    _this.threshold = 100;\n\n  },\n\n  handleCanPlayThrough: function() {\n    var _this = this;\n\n    // Unbind from this event so it only happens once\n    _this.$video1.off('canplaythrough.video1');\n\n    // Bind scroll\n    _this.bindScroll();\n  },\n\n  bindScroll: function() {\n    var _this = this;\n\n    // On window scroll\n    $(window).scroll(function(event) {\n      // Get the scroll position\n      var scrollTop = $(window).scrollTop();\n\n      // ...handle it\n      _this.handleScroll(scrollTop);\n    });\n  },\n\n  handleScroll: function(scrollTop) {\n    var _this = this;\n\n    if(_this.canAutoplay) {\n      if(!_this.toPlay && scrollTop > _this.threshold) { // First video is to play and postition is below threshold\n        _this.playAndSwitch();\n      } else if(_this.toPlay && scrollTop < _this.threshold * 0.8) { // second video is to play and postition is above threshold * 0.8. Value was made up, it will change based on design\n        _this.playAndSwitch();\n      }\n    }\n  },\n\n  playAndSwitch: function() {\n    var _this = this;\n\n    // Get video to play\n    var $videoToPlay = $(_this.$videos[_this.toPlay]);\n\n    // Check it isn't playing already\n    if(!_this.playing) {\n\n      // Play video\n      $videoToPlay[0].play();\n\n      // Set playing to true\n      _this.playing = true;\n\n      // Listen for video ended event\n      $videoToPlay.on('ended', function(event) {\n        // Set playing to false\n        _this.playing = false;\n\n        // Switch videos\n        _this.$videos.removeClass('u-hidden');\n        $videoToPlay.addClass('u-hidden');\n\n        // Reset position to 0\n        $videoToPlay[0].currentTime = 0;\n\n        // Switch toPlay value\n        _this.toPlay = _this.toPlay ? 0 : 1;\n\n        // Remove event\n        $videoToPlay.off('ended');\n\n        // DEBUG\n        if(WP.wp_debug) {\n          $('#video-displayed').text(_this.toPlay);\n        }\n\n        // Recheck scroll position in case user scrolled while playing\n        _this.handleScroll($(window).scrollTop());\n\n      });\n    }\n  },\n};\n\nSite.WhatIsVideo = {\n  $player: $('#what-is-video-player'),\n  $video: $('#what-is-video'),\n\n  init: function() {\n    var _this = this;\n\n    _this.$player.on('click', _this.handleClick.bind(_this));\n  },\n\n  handleClick: function() {\n    var _this = this;\n\n    if (_this.$player.hasClass('playing')) {\n      _this.$video[0].pause();\n      _this.$player.removeClass('playing');\n    } else {\n      _this.$video[0].play();\n      _this.$player.addClass('playing');\n\n    }\n  },\n};\n\nSite.Menu = {\n  init: function() {\n    var _this = this;\n\n    $('.js-scrollto').on('click', function() {\n      var section = $(this).data('scroll');\n\n      _this.scrollTo(section);\n    });\n  },\n\n  scrollTo: function(section) {\n    var _this = this;\n    var $target = $('#section-' + section);\n\n    $('html, body').stop().animate({ scrollTop: $target.offset().top }, Site.animationSpeed);\n  }\n};\n\nSite.Countdown = {\n  $countdown: $('#countdown'),\n  $countdownDays: $('#countdown-days'),\n  $countdownHours: $('#countdown-hours'),\n  $countdownMinutes: $('#countdown-minutes'),\n  $countdownSeconds: $('#countdown-seconds'),\n  dayInSeconds: 60 * 60 * 24,\n  hoursInSeconds: 60 * 60,\n  interval: undefined,\n\n  init: function() {\n    var _this = this;\n\n    // get end time from markup\n    _this.end = _this.$countdown.data('end');\n\n    var now = moment().utc();\n    var nowUnixTimestampSeconds = now.format('X');\n\n    // calculate seconds between endtime and now\n    _this.secondsRemaining = _this.end - nowUnixTimestampSeconds;\n\n    // check if already finished, then display countdown values\n    _this.checkFinished();\n    _this.displayRemainingTime();\n\n    // setup interval to count down each second and update the display values\n    _this.interval = window.setInterval(function() {\n      _this.secondsRemaining--;\n\n      _this.checkFinished();\n      _this.displayRemainingTime();\n    }, 1000);\n\n  },\n\n  displayRemainingTime: function() {\n    var _this = this;\n\n    // each of these calculates the remaining values from the seconds remaining, then calculates the remainder of seconds to be used in the next step, then displays the values\n\n    var daysRemaining = _this.secondsRemaining / _this.dayInSeconds;\n    var daysRemainingRemainder = _this.secondsRemaining % _this.dayInSeconds;\n\n    _this.$countdownDays.text(Math.floor(daysRemaining));\n\n    var hoursRemaining = daysRemainingRemainder / _this.hoursInSeconds;\n\n    _this.$countdownHours.text(Math.floor(hoursRemaining));\n\n    var hoursRemainingRemainder = daysRemainingRemainder % _this.hoursInSeconds;\n\n    var minutesRemaining = hoursRemainingRemainder / 60;\n\n    _this.$countdownMinutes.text(Math.floor(minutesRemaining));\n\n    var minutesRemainingRemainder = hoursRemainingRemainder % 60;\n\n    _this.$countdownSeconds.text(Math.floor(minutesRemainingRemainder));\n  },\n\n  checkFinished: function() {\n    var _this = this;\n\n    // if there are no seconds remaining kill the countdown\n    if (_this.secondsRemaining <= 0) {\n      window.clearInterval(_this.interval);\n\n      // perhaps we have a better solution but for now just remove the countdown\n      $('#section-countdown').remove();\n    }\n  }\n};\n\nSite.init();\n"]}